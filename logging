import os
import json
import logging

logger = logging.getLogger()
logger.setLevel(logging.INFO)
handler = logger.handler[0]
handler.setFormatter(logging.Formatter(“[%(asctime)s] %(levelname)s:%(name)s:%(message)s”, “%Y-%m-%d %H:%M:%S”))

def get_files(folder_name):
    """Get all files in a folder recursively."""
    files = []
    for root, dirs, file_names in os.walk(folder_name):
        for file_name in file_names:
            if file_name.endswith('.yaml') or file_name.endswith('.yml'):
                files.append(file_name)
    return files

def main(event, lambda_context):
    """Main function."""
    files = {}
    folders = ["threat/actor", "domain/study"]
    for folder in folders:
        for file in get_files(folder):
            if folder not in files:
                files[folder] = []
            files[folder].append(file)

    return {
        'statusCode': 200,
        'body': json.dumps({
            "data": files,
        })
    }

def my_logging_handler(event, context):
   logger.info('got event{}'.format(event))
   logger.error('something went wrong')
   return ' Hello from Lambda!'
